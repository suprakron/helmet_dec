{% extends 'students/base.html' %}

{% block content %}
<h2>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏ß‡∏°‡∏´‡∏°‡∏ß‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h2>

{% if logs %}
<div class="table-responsive">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4>‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏ß‡∏°‡∏´‡∏°‡∏ß‡∏Å‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h4>
        <a href="{% url 'daily_no_helmet_report' %}" class="btn btn-danger">
            <i class="bi bi-file-earmark-pdf"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
        </a>
    </div>

    <table id="noHelmetTable" class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
                <th>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</th>
                <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
                <th>‡∏Ñ‡∏£‡∏π‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ä‡∏±‡πâ‡∏ô</th>
                <th>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô PDF</th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td>{{ log.timestamp|date:"H:i:s" }}</td>

                <td>
                    {% if log.student %}
                        {{ log.student.student_id }}
                    {% else %}
                        -
                    {% endif %}
                </td>

                <td>
                    {% if log.student %}
                        {{ log.student.full_name }}
                    {% else %}
                        ‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏ä‡∏∑‡πà‡∏≠
                    {% endif %}
                </td>

                <td>
                    {% if log.student %}
                        {{ log.student.level }}
                    {% else %}
                        -
                    {% endif %}
                </td>

                <td>
                    {% if log.student %}
                        {{ log.student.department }}
                    {% else %}
                        -
                    {% endif %}
                </td>

                <td>
                    {% if log.student %}
                        {{ log.student.teacher }}
                    {% else %}
                        -
                    {% endif %}
                </td>

                <td>
                    {% if log.student %}
                        <a href="{% url 'student_report' log.student.id %}" class="btn btn-sm btn-primary">
                            PDF
                        </a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

</div>
{% else %}
<div class="alert alert-success">
    ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏ô‡πÉ‡∏î‡πÑ‡∏°‡πà‡∏™‡∏ß‡∏°‡∏´‡∏°‡∏ß‡∏Å üöÄ
</div>
{% endif %}

<!-- DataTables -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

<script>
$(document).ready(function () {
    $('#noHelmetTable').DataTable({
        "pageLength": 10,      // ‡πÅ‡∏™‡∏î‡∏á 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤
        "lengthChange": false, // ‡∏õ‡∏¥‡∏î dropdown ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤
        "ordering": true,
        "order": [[0, "asc"]], // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ascending
        "language": {
            "search": "‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠: ",
            "paginate": {
                "next": "‡∏ñ‡∏±‡∏î‡πÑ‡∏õ",
                "previous": "‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤"
            },
            "zeroRecords": "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
            "info": "‡πÅ‡∏™‡∏î‡∏á _START_ ‡∏ñ‡∏∂‡∏á _END_ ‡∏à‡∏≤‡∏Å _TOTAL_ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",
            "infoEmpty": "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•",
            "infoFiltered": "(‡∏Å‡∏£‡∏≠‡∏á‡∏à‡∏≤‡∏Å _MAX_ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)"
        },
        "columnDefs": [
            { "orderable": false, "targets": 6 }  
        ]
    });
});
</script>

{% endblock %}
